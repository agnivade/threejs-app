<!doctype html>

<html>

<head>    

    <title>Rotating cube - WebGL experiment</title>



    <style>

        BODY { 

            background-color:#000000;

            color:#FFFFFF;            

            font-family:sans-serif;

            font-size:1.00em;

        }        

    </style>



</head>

<body>

    <div id="container"></div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r71/three.min.js"></script>

   

    <script>

        // globals

        var renderer;

        var scene;

        var camera, mirrorCamera;

        var W = window.innerWidth - 25;

        var H = window.innerHeight - 25;

        var cube;

        var plane;

        var SPEED = 0.001;

        var spotLight;





        // initialise

        function init() {

            // create new scene

            scene = new THREE.Scene();



            // setup renderer

            renderer = new THREE.WebGLRenderer();

           // renderer.setClearColor(0x000000, 1.0); 

            renderer.setSize(W,H);

            renderer.shadowMapEnabled = true;

            //renderer.shadowMapSoft = true;

            

            // setup camera pointing at scene

            camera = new THREE.PerspectiveCamera( 80, W/H,  1 , 50000);

            camera.position.x = 1;

            camera.position.y = 1;

            camera.position.z = 1;

            camera.lookAt(scene.position);

             

             



            // draw a cube

            var cubeWidth = 0.5;

            var cubeHeight = 0.5;

            var cubeDepth = 0.5;

            var cubeGeometry = new THREE.CubeGeometry(cubeWidth, cubeHeight, cubeDepth);

            var cubeMaterial = new THREE.MeshPhongMaterial({ color: "yellow", ambient: "white", shininess: 9, metal: true, reflectivity: 9 });                

            cube = new THREE.Mesh(cubeGeometry, cubeMaterial);

            // make the cube cast and recieve shadow

            cube.castShadow = true;

            cube.receiveShadow = true;            

            scene.add(cube);

            

            // draw a floor (plane) for the cube to sit on 

            var planeGeometry = new THREE.PlaneBufferGeometry(4, 4);

            //var planeMaterial = new THREE.MeshLambertMaterial({ color: "white" });  

            var planeMaterial = new THREE.MeshPhongMaterial({ color: "yellow" });

            plane = new THREE.Mesh(planeGeometry, planeMaterial);

            // make the plane recieve shadow from the cube

            plane.castShadow = true;

            plane.receiveShadow = true;

            plane.rotation.x = -0.5 * Math.PI;

            plane.position.y = -1;

            

            plane.receiveShadow = true;





            scene.add(plane);

   



           



            // LIGHTS

            var ambient = new THREE.AmbientLight("white");
            scene.add(ambient);


            // add a spotlight to illuminate the cube and cause shadows            
            spotLight = new THREE.SpotLight("green");

            //spotLight = new THREE.DirectionalLight(0xdfebff, 1.75);
            spotLight.name = "spotLight";
            spotLight.position.set(4, 4, 1);

            

            spotLight.castShadow = true;

            //spotLight.shadowCameraVisible = true;

            spotLight.shadowMapWidth = 512;

            spotLight.shadowMapHeight = 512;

            spotLight.intensity = 1;

            spotLight.shadowDarkness = 0.1;

            spotLight.shadowCameraNear = true;   // this line makes the shadow appear, hooray!

            

            scene.add(spotLight);

            

            // render it!

            document.body.appendChild(renderer.domElement);

            render();



        }

         



        // do the render

        function render() {

            requestAnimationFrame(render);

              





            // randomly turn the cube

            cube.rotation.x += Math.PI * SPEED * 0.8;

            cube.rotation.y += Math.PI * SPEED * 1.0;

            cube.rotation.z += Math.PI * SPEED * 0.5;

            scene.getObjectByName("spotLight").position.set(4,cube.rotation.x,cube.rotation.z);



            renderer.render(scene, camera);

        }



        init();        

        render();



        





    </script>



</body>

</html>

